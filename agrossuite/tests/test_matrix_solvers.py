from agrossuite import agros

from .scenario import AgrosTestCase

import numpy as np


class TestMatrixSolversGeneral(AgrosTestCase):
    @classmethod
    def setUpGeneral(self):
        # read reference matrix and rhs from file
        self.reference_sln = [1000000000.0, 852486051.482735, 1000000000.0, 842292146.2453941, 1000000000.0, 847193130.6754296, 921660019.8424863, 916159366.2695596, 918825760.894945, 730634923.5186646, 710830223.4056774, 720466527.0367888, 789435574.9736534, 774535923.399624, 781713040.0510058, 1000000000.0, 832732039.7319064, 1000000000.0, 837785083.5234952, 908509611.3588251, 913277599.0491241, 693270595.3500209, 701767345.5497267, 761664953.7736784, 767924855.3705122, 1000000000.0, 821224753.7498252, 1000000000.0, 836483642.8743759, 1000000000.0, 828803659.6652668, 903987355.6491325, 912481112.270099, 908075909.0132538, 679159846.4238383, 704513562.9097723, 691752832.8230163, 747371114.0106975, 767938073.8670012, 757529453.4622718, 1000000000.0, 844392028.1984575, 916998059.2993914, 717472392.9954318, 778568910.6212497, 552967146.5802245, 630277107.390106, 591261228.0965177, 614824029.215604, 666640373.7844483, 640497527.2600331, 433166989.01823664, 561235457.892137, 496816002.41991943, 492658711.21873266, 595185674.1446935, 543508043.0067616, 670096281.7494154, 693283138.3879342, 626632138.1543673, 647869829.6790175, 829034500.8084743, 741736450.1106315, 902208720.9017133, 785455855.7610422, 786061005.4141989, 843233527.0495214, 652108140.9801301, 672303110.3922617, 697048184.7047014, 728584655.03214, 706996692.1365212, 661640763.6612227, 765443394.9802785, 700658535.5754101, 684723778.1465628, 733657559.4091583, 613958789.7383779, 632651693.5255487, 637982617.1670982, 666894072.0298378, 439448637.5236207, 545403292.6837034, 492328212.5936683, 435940364.67983854, 553038062.8054422, 494267504.31326413, 449326288.1731137, 532133582.07525027, 490827029.8224873, 443833964.16011196, 538400789.9638295, 491143752.01917547, 598661716.4708731, 612366981.078247, 573178310.6606895, 585580781.1471236, 487345229.09247434, 596894371.9000752, 464448293.3592543, 564024302.2700198, 474450444.0477138, 580460760.013555, 542791731.9478751, 514584618.51820326, 528046601.2793352, 651336674.3486706, 612904258.1953882, 632404184.2673372, 456098078.8353512, 547892060.9785863, 502249110.07941866, 593092673.498132, 227411343.57344392, 257890693.32446623, 328822675.3635283, 343051867.4353868, 279074276.78152156, 301153413.1912908, 242733100.77925995, 335949923.2169467, 290156376.01609534, 287717226.12901807, 357185186.0096216, 322903991.626393, 272883925.95609325, 350129564.37172437, 312068329.0288045, 423005013.0603921, 423053698.16906476, 376751593.1234278, 383655835.9180225, 423016238.23624367, 380199035.0387032, 423227229.8567612, 390609151.719516, 423122131.51770115, 387124500.62868226, 0.0, 117999153.63997956, 117980295.43404673, 189666924.0293213, 60083787.34313248, 154272642.97579485, 60086791.45996287, 154258556.34823757, 107902762.45872037, 227551325.38410938, 257963901.78992635, 242841505.1715908, 173791912.28977066, 224225960.0285441, 199235480.73460966, 173735181.98638612, 224199794.40148112, 199191495.9796982, 272921875.1432447, 248772332.4095409, 329332478.8419991, 343286998.2294125, 336315515.3840167, 279362755.4270349, 301290377.11943364, 290365527.47977334, 424310409.10476696, 423597650.23650956, 423893647.6105157, 377599933.3428239, 384022898.7860846, 380781634.0038704, 350244636.76323843, 312136057.4339537, 423381594.9509914, 387300586.795257, 394392843.21641403, 392797605.9693879, 441597129.0429904, 429384323.2643614, 392979422.71183574, 434903894.259133, 395870455.5612805, 422880013.0566644, 393750946.3498243, 425459792.4345182, 291395956.181146, 314195962.02350664, 344534559.113172, 354408947.3673996, 302269182.996111, 348884692.86623293, 339908085.15247226, 368220463.8653817, 326818706.85774916, 360898084.89352, 343855331.8440366, 368513057.4632546, 355895322.21050316, 389285081.4037061, 404453016.50250494, 396529585.6138833, 247241340.68214333, 293263123.8625779, 270183220.1966193, 296620820.9472612, 331486468.9573498, 313824446.136729, 381821396.66873085, 413197843.6189924, 316535727.4654564, 349617930.3358341, 0.0, 170883538.9986484, 139769465.9360087, 230938869.9552138, 80192334.33837168, 199828600.11103746, 98526851.77267775, 186453082.55725202, 142662538.28982225, 234144142.24834442, 273503429.15760934, 252945483.66280153, 195325943.82066485, 262154942.9806341, 228903516.93827128, 294833258.2295583, 846281810.8968607, 818727999.617152, 774397325.0085377, 768288590.4535568, 811348221.8540114, 794446645.0241276, 829945321.6608529, 769528715.1005346, 800713688.1207106, 816621097.4652206, 778945015.849953, 798675551.432417, 813707076.1132967, 771224374.1671258, 793454959.3335359, 692867404.6689641, 709269407.0648211, 735030772.4306436, 739951174.5238322, 700092505.4538678, 736080934.6026258, 734039255.9119924, 757363612.9153783, 720529990.9549334, 746938273.3731608, 856436770.7710841, 790521718.7064143, 901556168.951024, 805975861.429707, 824621523.7942411, 854594487.2566813, 717855586.7329355, 711763584.4425446, 754746437.1276327, 758441167.0661443, 829270836.1299843, 781733182.4573482, 806862241.8594992, 725272358.4086239, 754429507.4666982, 598786273.0724171, 654415847.1357484, 625689694.4321035, 546260153.5951109, 625957524.2932619, 585373751.4305466, 647598222.0719397, 682185943.1204268, 663880616.9599504, 685075188.0299845, 667964117.5044899, 702601290.0196259, 915109382.4858975, 929466523.626372, 904212991.88996, 908888652.9447926, 906929654.0499669, 917385664.2538756, 921712947.9298687, 905417235.1334759, 911320610.5938841, 948872157.7773565, 923076895.7359855, 935167293.2054621, 938437883.6920587, 914636577.7082624, 925246117.3694124, 912373168.7031211, 902036689.7415335, 906171291.6413065, 903823554.4408032, 905704367.1968883, 903708786.7812953, 904659323.7979378, 912763276.227675, 901473923.3423333, 906775578.249953, 1000000000.0, 1000000000.0, 948716177.552956, 960370156.3628693, 973175196.6979526, 979518942.3932393, 1000000000.0, 954665493.4774377, 976483151.4193287, 1000000000.0, 971902835.8838651, 985332702.809403, 1000000000.0, 966022528.3943466, 982413264.7235066, 929143913.2454234, 943488437.2343814, 936154870.4667917, 959736855.5156571, 951257199.9680868, 1000000000.0, 950347149.3799348, 971266282.5419278, 1000000000.0, 961631665.8010696, 979159401.8452853, 925852719.674331, 946716203.7063497, 1000000000.0, 938119833.3277837, 960960598.7654682, 934808257.0129462, 947150190.1113235, 911712878.3667085, 922976946.1226776, 458859628.9577288, 381710137.92489415, 467838615.33852035, 383653881.59178615, 421291414.6398907, 426647509.33609134, 294451030.3977076, 289662586.30978113, 339622219.2525154, 338171285.41013753, 489451171.3637905, 415238097.6022825, 464986424.9371456, 391533182.1940661, 453458934.7863311, 429352257.8589556, 330498358.49151677, 307720243.30903184, 374421662.51302445, 351136981.5035767, 250152789.5629863, 250843476.30493677, 244962896.60975167, 140239113.55065316, 205335771.06196284, 163187310.05596042, 446401404.972119, 374457129.5556355, 407622849.0725319, 352427700.21687734, 310341287.97146577, 326499845.15701175, 270414249.9740801, 247369264.59257436, 348585107.4982564, 304595398.31258214, 753505214.1935313, 596458740.9793669, 612656446.2027954, 492885960.69233346, 685914576.5810521, 546277290.1319879, 671432350.1787107, 549243944.4621754, 612555643.7138081, 533957288.21679485, 447473737.9390895, 492063294.4539805, 533040620.6257145, 435803016.58286554, 481057271.3294614, 399788155.3131842, 1000000000.0, 850244911.591065, 1000000000.0, 835042836.4243026, 1000000000.0, 842584491.9116648, 920295855.9597135, 911769445.9702178, 915990962.5140265, 728037655.8098831, 701785425.400664, 714812092.1406003, 786801138.019651, 765815551.8779038, 776207933.5703305, 820445898.3998771, 1000000000.0, 827692177.7979457, 903760076.2991519, 907621222.2733198, 676270381.1008728, 688942874.2976487, 745626849.9385228, 755610311.0799809, 1000000000.0, 834529422.13565, 911464998.6568882, 1000000000.0, 842342443.7774736, 915849179.5752331, 1000000000.0, 819082389.6493647, 903041582.3511242, 1000000000.0, 826808679.7902043, 907118377.0724, 701058274.1312172, 765156987.3075254, 714452923.9527963, 775890583.7572814, 674753612.628788, 744166333.856376, 687839176.6921424, 754575669.9579195, 622092003.3442785, 660922697.6237341, 661335877.7286, 687543536.3656751, 546214989.1002284, 609220789.3519864, 583790133.9722599, 634836731.37159, 547215567.6706994, 584247462.5291654, 610570577.03409, 635699388.319385, 484785408.13404477, 485349973.78572243, 534091487.7543028, 1301549853.688922, 1261763093.372233, 1264176987.3158064, 1220598976.695778, 1283160384.0835228, 1241552468.3603754, 1281907373.2235892, 1242463802.5433564, 1262540312.9344184, 1220153816.2928867, 1176693611.2278388, 1198717466.0358272, 1241161366.0238438, 1198657534.5915797, 1220259625.9315338, 1224229659.4319854, 1176144897.5036633, 1244546074.735068, 1198830831.9402885, 1199864652.38739, 1221603669.400338, 1130854687.0384839, 1154075186.9852011, 1153140280.2490077, 1176307807.0012846, 1370301708.9443207, 1299785133.0645318, 1336784964.6125152, 1280894830.5781465, 1353739432.433431, 1290357057.7660363, 1336270726.1480277, 1309504879.9578538, 1322975461.7704375, 1220102539.9637492, 1220097772.4410398, 1220097558.2945275, 1260973783.4030623, 1251053270.030635, 1256006215.6660428, 1319407759.639099, 1271372091.2748742, 1295829382.2247927, 1220110427.3445444, 1246107207.3358681, 1133746001.5959046, 1155337035.675981, 1144631167.3265064, 1177511067.827488, 1188145799.6661165, 1182859520.2190454, 1045847779.5453085, 1088049708.8918266, 1067037338.0938497, 1089538096.0142522, 1121866722.6976585, 1105816965.2512136, 1165980037.706731, 1193411990.2900527, 1109215018.4100523, 1137882676.159084, 1441356541.7924669, 1479543008.696157, 1406795325.0811586, 1475932664.8483431, 1424328266.103764, 1477600349.136996, 1461226743.6491272, 1443582537.2039742, 1452374655.6720579, 1511648426.472203, 1527818054.8153198, 1519892253.978559, 1496334124.6564188, 1503960759.0123007, 1500077849.8518412, 1473410078.8869483, 1388786033.7103803, 1474536150.450894, 1426212391.6773343, 1434859760.8244176, 1542616379.9356203, 1535400453.1232142, 1512083797.8805401, 1507966681.1094124, 1473730232.7054307, 1514649798.1463838, 1495356609.5190587, 1457844604.3839872, 1497925500.4286726, 1478864376.0153666, 1503435925.248766, 1543119995.6059525, 1524753056.452465, 1488953686.1851892, 1529710363.0847282, 1510665460.3345685, 1546518359.368803, 1531683578.2214925, 1530407805.729283, 1515086917.5165477, 1571162004.6236365, 1558579943.7545462, 1560068235.2387342, 1546160296.0560422, 1566682817.8768978, 1557286597.8559897, 1549584101.5693433, 1540386650.1074421, 1587800664.7934403, 1580896204.157389, 1579334892.5794053, 1570730055.677079, 1581251801.4051082, 1574680414.5065095, 1565542413.4822865, 1557974687.8139322, 1593192172.4780948, 1591898516.9453673, 1590362334.013446, 1585875931.739383, 0.0, 116687756.74187762, 0.0, 126210838.80537154, 60373442.394049905, 67181091.41011928, 220159063.16838965, 233095953.44398105, 169821352.60853118, 181428035.60919836, 0.0, 101799117.36105485, 0.0, 108681424.91945456, 51787874.127572246, 55584391.28676371, 196544493.52891818, 208046021.81746757, 150044852.34030005, 159465124.65960142, 335393487.75230914, 279043205.6061929, 307508431.4681218, 385108659.0269036, 311491052.7080094, 348825017.8541872, 230883253.03654832, 213632424.59996864, 222244118.39883175, 283998834.44247377, 246445916.12376404, 265326455.32308665, 249958976.50332457, 272983952.238186, 205060716.65415686, 227357210.28111377, 0.0, 0.0, 119265853.50231065, 110229399.92062059, 60625513.56437929, 55971105.455443524, 0.0, 114695741.59438728, 58261211.18499485, 0.0, 105907512.94698422, 53789721.13317205, 175994006.27682245, 162782832.67795363, 169348036.74181417, 156333022.4956152, 207383139.03685287, 270003457.46565604, 239016542.02383208, 217496435.3042483, 300004680.5288087, 259339211.15846488, 186977792.0830155, 207873755.7108927, 197448649.86716685, 197210023.63985774, 239302008.69861126, 218389560.05147088, 330198294.5096245, 300386060.97981954, 378118945.8702361, 339574067.85875684, 228621704.95585212, 218262652.7403813, 280403006.2853112, 259967506.24574766, 0.0, 107135396.1902536, 54453742.198619455, 0.0, 112570993.02705115, 57271338.46132254, 0.0, 96237636.24149266, 48822985.06883523, 0.0, 101690202.35790695, 51637419.71597975, 158095249.23922417, 165959934.6479995, 142278200.83365923, 150200911.19656318, 0.0, 107429621.09605098, 54604949.7847474, 0.0, 101826296.850654, 51705405.862550646, 118736498.35421017, 60498400.556283645, 0.0, 113059523.12209727, 57531105.65197438, 158508025.13249424, 150396870.86996096, 174757021.58988383, 166623884.5623985, 1611784723.1076934, 1515069174.2124493, 1427485301.1728938, 1344777986.5285354, 1532688402.9713247, 1438158134.956837, 1567028860.5529306, 1386943200.5874374, 1487522799.6988335, 1387471750.3428562, 1257548717.7633462, 1326246803.2050853, 1455415167.3916001, 1301413495.7972782, 1384375481.7166188, 1121484173.1985567, 1096244337.6107147, 1292213297.1955132, 1231861157.83758, 1106906691.5360343, 1261456909.7957454, 1092031264.3342628, 1179810168.6880088, 1090692890.8876545, 1204297595.571014, 1735030472.0035641, 1696636608.328061, 1706992251.445907, 1632198505.510185, 1728458679.4873285, 1670289810.2335114, 1722596554.6191783, 1674772869.0716562, 1705198257.4328194, 1600496692.6998997, 1512752432.649056, 1560881916.6826365, 1656528642.8466487, 1578513390.834725, 1622549780.294165, 1669109625.6091137, 1580963575.5187767, 1629300152.2371206, 1455191596.9140303, 1523183179.7607415, 1435141108.771233, 1351169836.4628587, 1394633854.276741, 1527268712.2323313, 1439101819.7250519, 1486197437.9646177, 1192062587.371375, 1122148541.3509395, 1152786793.471712, 1322728726.6798348, 1246600942.7219973, 1284062593.6820028, 1305266038.9763703, 1385777335.8815117, 1101991176.5156004, 1211574955.6789382, 790437469.604564, 936170554.2029434, 895047393.9703851, 889144313.697907, 843600214.1741408, 818230780.8673244, 916115285.7052381, 866690724.3888185, 742985267.6286372, 851931987.7828033, 799847329.2213395, 764717621.7858759, 873426500.2960582, 820895782.6906137, 1035371619.8743799, 992295385.4899883, 985375202.8257594, 944659237.2033658, 1014381320.8737223, 965580990.4286947, 944601780.774489, 900011137.6556559, 969037339.2274284, 922723893.0248734, 901528480.8693645, 722265946.240673, 866743255.7514056, 729986591.9023126, 881555131.6470633, 829326443.8393987, 798651146.2769485, 809372151.2089183, 1029142661.3067392, 983611463.1008443, 1005671660.1326137, 968169567.3409467, 928103895.0796504, 946691193.4113387, 727875609.5707985, 856987289.6576793, 795810812.3750355, 963191570.892415, 912530716.5266453, 1133315204.0956452, 1135339405.943582, 1063854147.3273672, 1181678782.794696, 1099769551.6701593, 1179869655.1765816, 1099810960.2530036, 1141380734.2253573, 1084925396.526898, 1027872069.711107, 1057276187.0815114, 1084692448.9735367, 1025227145.6684158, 1054721676.1415231, 996560516.9709343, 566624725.0708278, 514939474.9454402, 579285349.995018, 525205144.2679347, 561731309.9680657, 525595234.50304043, 560744938.4302835, 514467353.40806186, 659549900.2801752, 614871877.2633182, 675488407.6260009, 629309631.4782609, 632340748.3289825, 597327287.3814766, 645144286.2575294, 604188239.2394269, 627439433.6864042, 672087355.1294996, 607508040.6246922, 665385323.6171241, 681284204.413137, 710850144.6751722, 652600315.642702, 688189262.4652165, 590318846.2664343, 560253729.8026509, 654952927.1653345, 622106131.3572978, 724265390.3381919, 748775663.1173077, 757278966.9907601, 783959295.5214165, 691626533.4897015, 712623110.3700448, 701525196.582169, 732476236.9824001, 672295463.8367274, 1471181721.7897568, 1394456865.717431, 1259820473.865583, 1222007132.3948212, 1374768501.5494726, 1313670636.4179869, 1433832999.4415882, 1240757190.6660912, 1344507517.2000496, 1310100319.8560433, 1185800922.2560353, 1250473723.3176458, 1353191433.091272, 1203668023.8080428, 1282301081.4964507, 964331275.0979406, 1001370015.1926742, 1123989706.892637, 1118289305.3834755, 982638005.4738635, 1120752437.2007632, 1040106481.8884145, 1115793208.529164, 1020513692.301132, 1116622308.1546478, 900767722.2127814, 1218764812.460465, 1053485361.8246015, 1170747212.2533903, 979940435.7036339, 1015333292.1992333, 1139562294.183378, 1079227182.8801405, 645718529.802958, 859528092.8493625, 757161334.8225448, 777717483.2955189, 960250209.8690666, 872710852.2718892, 1265257771.1049464, 1121974869.1068044, 1196591438.9999948, 953604146.3137531, 1041091108.3512537, 0.0, 558408626.5425522, 350227016.9846455, 714812172.6087383, 182992635.15503466, 638189053.9780204, 301624643.7496746, 543590440.8313088, 426822742.648306, 777144487.1667126, 866741178.5689435, 822366105.0067679, 503663952.09323347, 788486871.8245848, 653461649.8591855, 910457410.9408226, 0.0, 117001147.5194406, 0.0, 183403623.5428168, 0.0, 150206676.1518196, 59166883.5103065, 94203836.59261543, 76085590.53763668, 226733666.5291929, 344353604.014275, 287742268.3556609, 173111284.25033972, 266745849.23535874, 220970999.5250757, 0.0, 217212397.65408453, 114731066.92345181, 397184672.4465242, 310454146.1918853, 0.0, 302837000.36454177, 0.0, 203942373.85645485, 0.0, 253217035.41370064, 185182401.01864323, 107950322.83709362, 140921832.5690387, 487688165.5507266, 363719911.7214632, 427726529.0310723, 402632942.03367686, 288361020.05779594, 345866603.1948667, 0.0, 158706599.45117223, 81415309.21586914, 296625647.4300678, 230424433.1913756, 632852398.8165798, 499035187.81880003, 568441517.7242305, 564043473.9812342, 434619980.4767837, 501465653.81228465, 695731256.4521624, 558148557.8352667, 629590711.0976156, 424406668.52658767, 363243190.11276025, 480765762.19378614, 576670918.6551386, 719836572.7577688, 651957139.4483721, 531101113.7977209, 672508927.0969526, 605312804.407184, 671343584.2253674, 827454092.975514, 753448409.7702427, 624007018.8303754, 772475765.413751, 702037530.9908488, 838405868.6389389, 781652966.6481265, 790016264.7758715, 733735166.9646839, 956245028.1422276, 894712165.1230527, 895104733.9834218, 836485652.477969, 556003074.8014699, 551085369.0759237, 553298065.5123452, 359776925.9002548, 431949314.70437455, 386511427.8532828, 839922217.0102899, 750837894.8585104, 795657668.4977733, 714190848.0812007, 657437361.2844912, 683095619.7281859, 560350074.193117, 480831399.6109074, 709178207.9851357, 637065334.2820787, 1039806957.3396724, 934361632.7926369, 987930069.4284617, 947381253.6285611, 848658368.2170073, 898207098.0770847, 1078878542.503665, 1137054267.1081288, 1120804463.5200233, 1010570513.9435776, 1066862094.8018141, 880409258.6437044, 799705572.7933391, 1018118424.5657045, 952727684.49606, 0.0, 0.0, 308072308.9537887, 326675301.21086794, 159998649.3297341, 169844066.40875596, 0.0, 316598606.2252192, 164310406.67411968, 0.0, 337938731.66160506, 176170570.15424228, 572489660.2434826, 607377580.9155014, 445401130.5626442, 472177128.4391302, 589391600.8755624, 458034705.02671474, 626198163.0752892, 487477585.68668365, 738851459.1770549, 648234373.7450137, 948401207.0339291, 780465402.6384244, 849084916.0660431, 716061938.1735598, 691139845.4363632, 865072284.5525703, 781573350.7429514, 608980265.5637184, 694651564.474749, 652132659.5791956, 1038788003.9430153, 841950935.5602376, 942753005.972533, 736530416.6311089, 0.0, 469619665.4479668, 364840867.6002986, 300175850.23195744, 195136177.28186446, 0.0, 406012686.7461316, 225952464.15800765, 0.0, 333337017.8372422, 174428896.6227645, 615093095.5888916, 515056879.72070265, 559288460.6474265, 477791673.3960332, 1557032332.2430153, 1514568718.5953417, 1422700624.5595422, 1409246287.9318452, 1499441080.7905486, 1466878232.174015, 1536170895.6095524, 1414715376.1310563, 1482625897.1855867, 1470713358.1918614, 1406243928.2815094, 1439918164.8717606, 1492621900.3172941, 1406434824.9266095, 1452551011.243718, 1257163170.772045, 1322469672.3345501, 1339968814.4492, 1222679294.966637, 1329410530.6042898, 1330130449.5730402, 1369636829.9925692, 1293489555.3940861, 1353582765.9328468, 1648033072.9357374, 1625550349.3153648, 1626573646.0871403, 1587391015.8653255, 1642537617.53009, 1610312942.74338, 1639375613.4322789, 1608427379.5217438, 1628411891.13297, 1583487089.26549, 1538130431.2942545, 1563295944.858037, 1606814894.3925054, 1563834222.2894568, 1588492742.7060819, 1598686574.6370766, 1555798276.112852, 1578085823.5177586, 1507449865.2454727, 1532120795.7219174, 1525358285.813862, 1473801107.4911506, 1501462986.5051942, 1555987142.3338642, 1507519064.4579625, 1533946540.2897973, 1459945886.1666036, 1399592741.0143054, 1431105029.2983875, 1492784076.076753, 1437556503.3378818, 1466768698.8496258, 1442121469.832638, 1476304040.3895314, 1365736455.2710288, 1405155289.2455025, 1613823460.598261, 1602509460.8766108, 1603579785.342403, 1594939313.9437368, 1610331195.1281807, 1600488313.4967427, 1607801451.2190595, 1598795002.165396, 1604911963.3874133, 1596905871.4116614, 1590335734.384373, 1595492987.8979263, 1599001172.65286, 1592140248.1526246, 1597395784.467144, 1579986489.2992642, 1572650490.7339966, 1593495825.697489, 1585721224.65003, 1576083389.5246723, 1589235256.3876917, 1567328931.0581503, 1581061448.7011757, 1569732927.303014, 1582996100.1805184, 1579756374.9281814, 1551866636.841102, 1565904351.589928, 1581047643.3033993, 1539246809.7659142, 1560806027.4844806, 1579460458.4964752, 1563026881.4554996, 1571057739.6771095, 1525054055.2534292, 1538129152.6978276, 1495637402.2493598, 1517248736.6780612, 1548804436.2294087, 1555573108.4832184, 1628382384.0297782, 1611969517.5258632, 1622135831.2113233, 1638116264.1525886, 1618092876.2002351, 1630238801.8453748, 1620201843.9921381, 1607182101.6297815, 1615590362.8491483, 1597783133.7755117, 1601664965.8157713, 1595114299.5358016, 1006610485.009045, 1042327181.5226208, 1024131073.0936638, 1026600026.9804665, 1065416155.662758, 1045864290.1147947, 962968142.0153865, 994425428.2796772, 978143258.9845026, 985571544.277283, 1018702767.8665907, 1001640928.1941833, 1080934158.6632304, 1061260131.6469318, 1106099600.4478567, 1085447283.5388904, 1029667419.9718136, 1011660162.1770115, 1055433402.5082142, 1036663944.1200937, 911029857.1199327, 967533889.521521, 880538994.8813192, 952402189.1561762, 937854844.3723164, 914653461.2115092, 1032018355.3980564, 1033508530.1356399, 999154179.653973, 992370009.5498209, 938309596.3944703, 981537667.085234, 958954518.2939844, 1030774063.3004203, 1005611400.2467625, 1105639509.4117036, 1141403883.1645925, 1119056778.8246958, 1160238325.2161303, 1092963489.4413328, 1123380488.6063445, 1069091509.9644104, 1076687068.0345495, 1062043540.0244737, 1692672659.243513, 1674066454.9942713, 1714390071.6904976, 1684903326.846145, 1703197110.8620374, 1679407116.413265, 1686056367.3864098, 1703922655.513737, 1694882511.4577222, 1632637715.1287293, 1618095929.1759717, 1625852607.347599, 1656439741.8733408, 1656458991.0535316, 1656534420.4340518, 1725486937.9517014, 1690655837.8378673, 1713287097.4508948, 1609583647.9858072, 1656392458.8379328, 1669193837.9336736, 1649239913.3154938, 1662982747.0581665, 1681309662.945658, 1661595068.5792255, 1674486296.596875, 1657887729.252878, 1637449966.5037725, 1652261700.6185672, 1595905416.2641757, 1627177749.2356548, 1614733347.9055948, 1641908385.3067203, 1576538074.0910685, 1612628750.2017672, 1530798157.6477644, 1566964955.2682316, 1577492576.2686281, 1597795826.1137476, 1478605318.1133037, 1533885309.811549, 1486997336.8711085, 1553921739.1694243, 1409171607.5510876, 908110916.4931968, 934433096.7909853, 929577862.8728796, 921923070.928168, 918163627.7397652, 911669052.0916548, 932683190.43183, 921065008.0438644, 893376899.4544666, 919259771.6628724, 906571240.6624635, 901876337.4361905, 925093989.2560099, 913275638.0720243, 966141260.4760336, 955817706.535246, 949293570.5193958, 942180272.413617, 961173049.6914222, 946143712.0116264, 943741131.4716417, 931618340.8623569, 950031831.4218762, 937355722.1090596, 871435185.1586069, 915442337.0555768, 859010290.9353635, 913206955.6258515, 894461515.213252, 887558374.8033812, 952928497.7398318, 957818429.63492, 934842499.2102443, 936493915.1843891, 883065771.5933425, 917515594.397331, 900883866.9378209, 948248657.9267409, 933246564.9283274, 1004093706.5591094, 979937988.9601283, 992280549.317897, 1024618231.3318667, 993003127.5584122, 1009124644.9341962, 984499137.6203665, 967515277.0083148, 976241190.7529927, 966899378.1252126, 976021021.1918647, 958230062.5186305, 819300676.1034622, 723241058.4216305, 769913724.6489137, 903175778.2733939, 769847103.5575855, 833256457.6898587, 674591914.8059275, 635772731.39774, 655052944.3494238, 744125756.0191324, 678714311.4086031, 710873357.5601219, 635830866.820048, 678762121.1763676, 655136390.3129467, 710953683.5936853, 597980610.7601974, 616765613.5116644, 616788759.2238561, 647415491.929534, 545592278.2975794, 527434852.57386136, 536494585.3042117, 608893729.6795769, 580875240.5326174, 594823263.4966612, 483879686.88152385, 474965852.21696496, 479411236.2718718, 509445754.0377367, 518417179.21075046, 553293043.2296647, 567035342.9387833, 466161775.5733103, 470547684.4546981, 527691551.50763714, 581035540.803233, 536904427.7891369, 595070785.1358963, 518539313.1422931, 567115523.5549933, 475362440.36819494, 480044764.440871, 470738803.66589504, 874496950.6388601, 866331351.9322135, 896787977.2346526, 899702873.8213897, 846882024.8725976, 832570487.147123, 857931002.9947753, 844939397.2507688, 886330528.7881812, 880826196.8394535, 895266987.8799661, 895343208.7205174, 870169679.6213907, 859362304.7198398, 877862552.881329, 868798563.7341557, 851444292.8413447, 859867204.3403342, 835722101.3216121, 845349948.495789, 877835672.0759304, 884764738.4396745, 865538189.5428921, 873115645.8631016, 846862810.0378218, 831135154.5793453, 872860555.7150182, 860799014.9933633, 892393460.7535694, 897970013.6440867, 899204880.7211474, 903604152.2165885, 887970007.9284241, 895077770.28315, 885554229.9846631, 892791836.8174106, 880471016.2763455, 723817010.4595538, 770713347.7066864, 771219181.9641773, 834182255.5581417, 634648299.9764749, 655274647.7592067, 678454149.4723461, 711451524.9325739, 636167639.758635, 679147615.0530837, 657497673.0462631, 712736451.5264925, 594372150.0803118, 614360967.6594071, 615137364.1580507, 646405089.875285, 528200752.8541484, 537650868.3654904, 580774419.0163196, 595583583.9338527, 425250093.6165511, 424720133.7967259, 476489094.4257284, 480875532.9725489, 509663781.3889132, 518866332.0467377, 551678635.8184247, 566141236.9286249, 426773342.6169469, 425921219.05722916, 468093796.74296427, 472220600.3499047, 530947160.72957474, 582897219.5276953, 541848024.5704478, 598767080.9321662, 520223937.4180842, 567206812.5012995, 429226768.3098035, 479870805.9551022, 430962986.7934369, 486116509.93314725, 427855914.08921605, 473876001.6057316, 346435453.169444, 338303646.86027986, 386455339.15227264, 382245685.21067816, 262396217.16623998, 245587178.8682258, 305103628.86933315, 292778920.2598369, 362845921.2358659, 354610457.55346525, 395209852.3464219, 390768186.72489095, 295576847.3659591, 279056272.9300953, 329645567.31565255, 317388458.3807869, 192755181.87517563, 156506196.23758376, 156153327.22354662, 109171850.09988676, 263633569.45058426, 247362886.54149774, 228572321.84814218, 202554884.1034868, 228042157.48842043, 201611633.51263356, 279702633.5908617, 254066922.9865914, 348936278.7050926, 389687077.32216454, 342105920.3060975, 387249722.19191813, 355855726.0514643, 392353667.4600079, 306930385.58520365, 295489495.5175788, 318316356.6497731, 1391187742.8570986, 1314802281.1768408, 1393229744.8853633, 1337998771.5366735, 1391992258.787767, 1325840903.643895, 1354757452.0978653, 1366679884.6287022, 1360356315.3678555, 1273684675.2147477, 1247649550.9269953, 1271283125.5329778, 1307059832.5450094, 1288320912.5135374, 1397124117.9433806, 1365721197.3736038, 1394927826.2688887, 1351306834.478102, 1381644711.7276843, 1373769278.4562643, 1332743394.2139666, 1302217118.970752, 1349387713.3935215, 1327477723.890495, 1470629556.3392587, 1435399496.093386, 1461182803.872172, 1414532921.119624, 1465051172.3585734, 1424674068.2195978, 1453440332.826775, 1438283799.6887355, 1445279192.2978294, 1416599297.7464826, 1390259404.758486, 1403414567.676652, 1396947462.9677365, 1459385215.6754556, 1405176108.0661483, 1428984094.6150084, 1432742088.864594, 1364577510.1423328, 1377252005.439528, 1453783653.8582146, 1485551196.9680238, 1443220749.8862522, 1494253316.2560132, 1448221244.5153177, 1480167440.6063025, 1465336799.691249, 1472477681.33625, 1424162713.598893, 1419185788.8844035, 1421409949.3266141, 1477572739.2496483, 1438899802.5271792, 1458918654.7122047, 1417556251.938456, 1567841888.0447743, 1578898702.2846951, 1541097662.6087832, 1563921650.113667, 1555767494.4842389, 1572118010.9149384, 1573752695.6684659, 1553324772.0445523, 1564522839.3368256, 1586844472.7429888, 1580211893.6939635, 1583829339.2521842, 1583265647.6293597, 1572883098.782312, 1578555855.0011847, 1523692956.6307106, 1554269192.817515, 1540098433.6108837, 1575990371.0970793, 1566231225.1031275, 1587077209.2349927, 1589623895.9613135, 1588402943.792151, 1579203364.0609207, 1585206150.4873004, 1582389645.4222815, 1593086932.4848115, 1593096755.2985911, 1593089425.9572215, 1591629490.5126848, 1592236099.3388472, 1591932334.142661, 1591625768.8867195, 1590705623.227763, 1589648151.1732032, 1587632842.6143618, 1593191288.815726, 1593138756.4999003, 1592800894.5742009, 1592529425.1073718, 1589959264.9045317, 1590860913.9581878, 1585907465.98866, 1587940643.3968625, 1593193988.3283248, 1593195098.400264, 1592385098.383868, 1592609902.9112, 1588934977.148131, 1583556310.406281, 1593204227.0960774, 1592144978.9562843, 1360421426.970506, 1310025844.3396347, 1414546965.9162345, 1356127918.5042377, 1334782768.095141, 1385322951.8789687, 1265285955.4020352, 1300373560.7171855, 1286745203.173719, 1327618219.2428052, 1221163299.3520267, 1199380883.2675686, 1296551562.782045, 1257999249.6199446, 1209261002.8716717, 1276413451.1466198, 1185909629.4380744, 1227233062.464568, 1191620953.660764, 1241551937.4882865, 1197413472.5614793, 1165374297.3544908, 1237026142.1468577, 1208139423.4542391, 1108017469.5304813, 1068442738.560174, 1154532971.9440753, 1118941292.0554113, 1230924257.2723114, 1267962640.4696505, 1147345630.1866758, 1190818445.9655912, 1027678976.5314902, 1063158551.1810117, 1043667945.8552011, 903088351.4081174, 985318482.7116941, 943195262.6297458, 1132544495.0846653, 1134505056.1890063, 1131941096.653059, 1084896328.3049538, 1027411014.6501508, 1139788579.5315144, 1410231046.3075712, 1432053695.965345, 1421143925.4893255, 1426203199.4991298, 1453784543.2285092, 1440123472.8999178, 1375763711.9019914, 1383026020.9602726, 1379287884.7974975, 1393424066.9781604, 1408482161.9401183, 1400874223.9119034, 1442944951.1310775, 1467150632.9741633, 1386990004.2950044, 1416246916.5457919, 1374625525.7469945, 1391027069.9016283, 1392720725.5222824, 1408890214.1573498, 1355974255.9077451, 1372639963.1643238, 1339850271.6578557, 1357574714.3485897, 1358120500.3721237, 1375803418.2920046, 1320983518.137631, 1338765995.8848774, 1327007749.0674446, 1333364945.667642, 1355895462.4044528, 1356884807.591872, 1296406279.5226185, 1308770004.1762598, 1320805219.4306881, 1355176063.7138274, 1283902195.3101063, 1582199213.5056164, 1576479595.6126063, 1590802633.6361704, 1589763686.5755033, 1587209381.324855, 1584114923.0258856, 1579456283.9249048, 1590245487.96206, 1585690125.8218338, 1569942819.0250964, 1589235991.1874871, 1580962901.2234437, 1573296195.3728607, 1589406440.4303427, 1582523356.7395766, 1593810419.3268297, 1594862277.9377348, 1592995473.9942322, 1593363057.786968, 1594224821.2252705, 1593106157.2687213, 1594581118.4764924, 1595805433.0717566, 1593851170.3031807, 1575491868.9053862, 1588757642.4223437, 1583278850.7126186, 1571768284.9973392, 1587863422.8561308, 1581245711.8561864, 1578980655.1491063, 1589745732.4246132, 1585276577.2380056, 1593089182.351976, 1592007088.9315352, 1593024872.0061922, 1591748630.3531322, 1593383555.7387874, 1592430640.4998937, 1560532938.7858527, 1551190740.7133558, 1568618999.5975268, 1562414821.6598103, 1540586374.7726376, 1522834458.0189934, 1551201972.9872875, 1538027628.8344455, 1569000396.9937048, 1574320370.833477, 1556394939.700784, 1563023014.2607818, 1525024863.0772164, 1506193239.2516048, 1532901403.9977784, 1514448160.493507, 1509152751.4682617, 1490793716.448972, 1517071297.070031, 1498248833.1306114, 1556643952.2937243, 1541877539.959807, 1563659853.2853658, 1549371004.2955737, 1540462425.2833774, 1525701737.7047656, 1548905974.586811, 1533969892.0129943, 1515248047.5277963, 1490251075.88642, 1511739165.2279253, 1489840708.7356656, 1519693299.7290611, 1492151105.7290351, 1554117481.7359946, 1536457622.2245004, 1547314566.6632657, 1530856794.0530975, 1560809789.1433444, 1542461233.9629226, 1576011018.6439896, 1566894613.6008604, 1583657447.8043487, 1574602510.911986, 1566194615.1298869, 1557808334.925838, 1583872669.5776558, 1590671881.820251, 1573976706.4037294, 1032307030.9615172, 942636590.6247405, 1027894138.8888106, 919363634.7299079, 1054267265.6789204, 1006715142.0183889, 1041129647.9895937, 972136696.0391511, 1179223633.8160484, 1110488703.033056, 1199986780.43445, 1120431118.3753402, 1140674891.3064122, 1098870551.0067968, 1159297842.4155476, 1103181463.146431, 1162940788.6017828, 1211804344.9122999, 1120672061.7478988, 1173308495.5450537, 1244507078.4710128, 1289356033.5125017, 1204470769.9608226, 1250887248.841712, 1110419948.6649127, 1065003358.5906498, 1195106974.763828, 1153898714.1151035, 1303743989.6950102, 1332638363.8912625, 1354813171.6058562, 1385587711.2972245, 1245509215.4336793, 1271148494.5332315, 1274201334.92583, 1322565016.4409113, 1220001831.7937531, 1764827279.2116787, 1759822526.5783627, 1772083847.5548785, 1761100740.7198029, 1768866191.6814482, 1760749882.6550562, 1764393281.1819298, 1769579536.197616, 1767339146.4575782, 1737097541.6973953, 1724849137.502496, 1731366192.1772742, 1750790078.8694365, 1746326899.6655154, 1748847471.7143078, 1775338146.788839, 1760226401.692873, 1774372110.832918, 1760913989.2699184, 1771739848.310634, 1771089356.3776183, 1709859197.510564, 1717643811.214778, 1739851635.2685454, 1743301607.680256, 1727403048.8408353, 1751503560.9008217, 1745133331.582242, 1743452124.5387912, 1736539799.1387308, 1736265061.6938114, 1751816683.581956, 1744235164.2707727, 1679245007.5433633, 1711254971.8809526, 1695990643.847633, 1708325322.666184, 1731624383.33842, 1720419183.3164494, 1758944038.564627, 1752962613.870082, 1758652917.6934693, 1724974558.6062284, 1741787052.8987331, 1592605450.5778952, 1670485953.215774, 1634694440.4568639, 1640508207.9219031, 1692626881.3514597, 1668297688.7968407, 1616785960.562516, 1551262715.2195463, 1536016407.8967514, 1645082639.0585027, 1595563412.7146056, 1700423537.5210364, 1713617159.4463794, 1669178993.8865788, 1685554313.858365, 780872540.8868487, 950992180.1282513, 757718046.1887872, 947466838.5478945, 869574528.2278107, 856851655.7511401, 1026320838.9267157, 1030455676.5156753, 847764386.2930163, 976929495.0308431, 811246901.883814, 960466905.1081095, 914222159.5683616, 888322089.587677, 1036173088.23629, 1027758054.3093541, 832891129.8898358, 991515823.8535967, 916334553.7124921, 833551305.4623376, 1011545835.5042145, 927973883.8255022, 838175147.8826398, 980285488.9175429, 912057460.1324458, 1059825050.3474187, 1085943888.796313, 1043414261.6655315, 653358630.6783762, 565117470.9984565, 597118318.0340427, 451357048.86575925, 717831727.847712, 663485010.2154918, 745223330.832538, 723020602.196372, 776056144.9020227, 1667269976.9614913, 1690410060.102554, 1702787877.987737, 1719715349.2275198, 1558331921.6985872, 1586513402.9713552, 1619563708.0602934, 1646547553.345052, 1602967943.2415285, 1638027130.1216595, 1644703765.382762, 1677673062.247486, 1495023304.8934448, 1527744359.8250616, 1553305970.3123534, 1588371083.0971859, 1415860440.5395463, 1420943597.209309, 1493293830.3338807, 1513014162.7839408, 1324701507.2549613, 1307681162.698667, 1409971940.692519, 1412240544.1088686, 1454294466.3757713, 1473688041.127081, 1361928854.8890765, 1342876678.8824534, 1510874909.5114892, 1560003251.1508741, 1553985225.6191552, 1603148021.083555, 1462963962.027092, 1510542483.3560207, 1455685238.9595335, 1497479583.8952792, 1410536264.4684649]

    @classmethod
    def tearDownClass(self):
    	pass

    @classmethod
    def model(self, solver, matrix_solver="", matrix_solver_method="none", matrix_solver_parameters=""):
        problem = agros.problem(clear = True)
        problem.coordinate_type = "axisymmetric"
        problem.mesh_type = "triangle"

        electrostatic = problem.field("electrostatic")
        electrostatic.analysis_type = "steadystate"
        electrostatic.matrix_solver = solver
        electrostatic.number_of_refinements = 1
        electrostatic.polynomial_order = 2
        electrostatic.adaptivity_type = "disabled"
        electrostatic.solver = "linear"

        electrostatic.matrix_solver_parameters['external_solver'] = matrix_solver
        electrostatic.matrix_solver_parameters['external_method'] = matrix_solver_method
        electrostatic.matrix_solver_parameters['external_parameters'] = matrix_solver_parameters                
                
        electrostatic.add_boundary("Source", "electrostatic_potential", {"electrostatic_potential" : 1e9})
        electrostatic.add_boundary("Ground", "electrostatic_potential", {"electrostatic_potential" : 0})
        electrostatic.add_boundary("Neumann", "electrostatic_surface_charge_density", {"electrostatic_surface_charge_density" : 0})
        electrostatic.add_material("Air", {"electrostatic_permittivity" : 1, "electrostatic_charge_density" : 1})
        electrostatic.add_material("Dielectric 1", {"electrostatic_permittivity" : 3, "electrostatic_charge_density" : 20})
        electrostatic.add_material("Dielectric 2", {"electrostatic_permittivity" : 4, "electrostatic_charge_density" : 30})
        
        geometry = problem.geometry()
        geometry.add_edge(0, 0.2, 0, 0.08, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.01, 0.08, 0.01, 0, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Source"})
        geometry.add_edge(0.01, 0, 0.03, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.03, 0, 0.03, 0.08)
        geometry.add_edge(0.03, 0.08, 0.05, 0.08)
        geometry.add_edge(0.05, 0, 0.03, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.05, 0.08, 0.05, 0, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.06, 0, 0.06, 0.08, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.05, 0.08, 0.06, 0.08, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.06, 0, 0.2, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.2, 0, 0, 0.2, angle = 90, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.01, 0.08, 0.03, 0.08)
        geometry.add_edge(0.01, 0.08, 0, 0.08, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Source"})

        geometry.add_label(0.019, 0.021, materials = {"electrostatic" : "Dielectric 1"})
        geometry.add_label(0.0379, 0.051, materials = {"electrostatic" : "Dielectric 2"})
        geometry.add_label(0.0284191, 0.123601, materials = {"electrostatic" : "Air"})
        
        computation = problem.computation()
        computation.solve()
        solution = computation.solution("electrostatic")
    
        return solution.solution()

   
class TestMatrixSolversInternal(TestMatrixSolversGeneral):
    def setUp(self):  
        self.setUpGeneral()
        
    def tearDown(self):
        self.tearDownClass()

    def test_dealii(self):
        # deal.II
        sln = self.model("dealii")
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "dealii sln failed.")                                                   


class TestMatrixSolversExternal(TestMatrixSolversGeneral):
    def setUp(self):  
        self.setUpGeneral()

    def tearDown(self):
        self.tearDownClass()
        
    def test_external_eigen(self):
        # UMFPACK
        sln = self.model("external_plugin", "Eigen", "none", "")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "EIGEN (external) sln failed.")

    def test_external_mumps(self):
        # MUMPS
        sln = self.model("external_plugin", "MUMPS", "none", "")        
        # print(len(self.reference_sln))
        # print(len(sln))        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "MUMPS (external) sln failed.")
